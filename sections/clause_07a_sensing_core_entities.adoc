[[sensing-core]]
== The SensorThings API Sensing Core Entities
All data model requirements classes are grouped in the following requirements class:


[requirements_class]
.Sensing Entities

====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req-class/datamodel/sensing/thing
requirement:: {identifier}/req-class/datamodel/sensing/location
requirement:: {identifier}/req-class/datamodel/sensing/historical-location
requirement:: {identifier}/req-class/datamodel/sensing/datastream
requirement:: {identifier}/req-class/datamodel/sensing/sensor
requirement:: {identifier}/req-class/datamodel/sensing/observed-property
requirement:: {identifier}/req-class/datamodel/sensing/observation
requirement:: {identifier}/req-class/datamodel/sensing/feature  
====

[[sensing-entities]]
=== Sensing Entities

The OGC SensorThings API v2.0 depicts the Core Sensing entities in Figure {counter:figure-num}
[#img-sta-core,link=images/GRP0001.png, reftext='{figure-caption} {counter:figure-num}', title='Sensing Core']
image::images/GRP0001.png[Sensing Core, align="center"]  


In this section, we define each entity depicted in <<img-sta-core>> and its relationships with other entities.
Additionally, we also provide examples to model the entities in different contexts.

[[thing]]
==== Thing

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/thing
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/thing/properties
requirement:: {identifier}/req/datamodel/sensing/thing/relations
====

The SensorThings API follows the ITU-T definition, i.e., with regard to the Internet of Things, a thing is an object of the physical world (physical things) or the information world (virtual things) that is capable of being identified and integrated into communication networks [ITU-T Y.2060].
A Thing is related to the Platform entity as described in Section 4.9.2.1 of [OGC 16-079] in a way that any entity that can be modelled as a Thing MAY be subsequently translated to a Platform and vice versa.

[example%unnumbered]
====
*Thing Examples*

- A weather forecasting facility that houses multiple weather sensors deployed across several sites
- A drone that mounts a LiDAR sensor for mapping purposes
- An upstream oil well that is equipped with compound gas detection devices
====
The SensorThings API follows the ITU-T definition, i.e., with regard to the Internet of Things, a thing is an object of the physical world (physical things) or the information world (virtual things) that is capable of being identified and integrated into communication networks [ITU-T Y.2060].
A Thing is related to the Platform entity as described in Section 4.9.2.1 of [OGC 16-079] in a way that any entity that can be modelled as a Thing MAY be subsequently translated to a Platform and vice versa.

[example%unnumbered]
====
*Thing Examples*

- A weather forecasting facility that houses multiple weather sensors deployed across several sites
- A drone that mounts a LiDAR sensor for mapping purposes
- An upstream oil well that is equipped with compound gas detection devices
====

[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/thing/properties

Each Thing entity SHALL have the mandatory properties and MAY have the optional properties listed in Table {counter:table-num}.
Each Thing entity SHALL have the mandatory properties and MAY have the optional properties listed in Table {counter:table-num}.
====
[#thing-properties,reftext='{table-caption} {counter:table-num}']
.Properties of a Thing entity
[width="100%",cols="5,17,3,3,3",options="header"]
|====
| *Name*
| *Definition*
| *Data Type*      | *Usage*  | *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating or updating the entity unless specified by the client.
| ANY              | Required | One

| `name`
| A property provides a label for Thing entity, commonly a descriptive name.
| String           | Required | One

| `description`
| This is a short description of the corresponding Thing entity.
| String           | Optional | Zero-to-one

| `properties`
| A JSON Object containing user-annotated properties as key-value pairs.
| JSON Object      | Optional | Zero to One
|====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/thing/relations
Each Thing entity SHALL have the direct relation between a Thing entity and other entity types listed in Table {counter:table-num}.
====

[#thing-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between a Thing entity and other entity types
[width="100%",cols="5,5,7,10a",options="header"]
|====
| *Entity Name*               | *Role*               | *Multiplicity*
| *Description*

| `Location`                  | Locations            | Many optional to many optional
| The Location entity locates the Thing.
Multiple Things MAY be located at the same Location.
A Thing MAY not have a Location.
A Thing SHOULD have only one Location.

However, in some complex use cases, a Thing MAY have more than one Location representations.
In such case, the Thing MAY have more than one Locations.
| `HistoricalLocation`        | HistoricalLocations  | One mandatory to many optional
| A Thing has zero-to-many HistoricalLocations.
A HistoricalLocation has one-and-only-one Thing.

| `Datastream`                | Datastreams          | One mandatory to many optional
| A Thing MAY have zero-to-many Datastreams.
|====





[[location]]
==== Location

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/location
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/location/properties
requirement:: {identifier}/req/datamodel/sensing/location/relations
====

The Location entity geo-locates the Thing or the Things it associated with.
A Thing’s Location entity is defined as the last known location of the Thing.

The Feature can be either a proximate feature of interest or the ultimate feature of interest depending upon the context of the Observation.
For __in-situ__ sensing applications, the Location MAY describe the coordinates of where the Thing is located.
The Feature is the entity for which the value of a property was determined by the Sensor.
The ObservedProperty in this case MAY characterize only the area around the sensing device or it MAY characterize the larger observedArea that the sensing application intends to capture.
Thus, depending upon the feature-of-interest, the Feature can then be either a ProximateFeatureOfInterest or UltimateFeatureOfInterest.
For __ex-situ__ sensing applications, the Location MAY describe the coordinates of where the Thing is located, whereas the feature MAY be the point location of the observed Feature.

Section 7.1.4 of [OGC 20-082r4 and ISO 19156:2023] provides a detailed explanation of observation location.

[example%unnumbered]
====
*Location Examples*

- An air quality sensing facility's Location can be the physical location where the facility is situated, but the (proximate) Feature that is characterized by the Observation could be the air envelope around the Sensor which is subsequently used to estimate the air quality of the district where the facility is situated.
- A drone that mounts a LiDAR Sensor may have its Location as the geo-referenced area over which the drone is scheduled to fly, whereas the Feature could be the individual objects mapped by the Sensor within that geo-referenced area
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/location/properties

Each Location entity SHALL have the mandatory properties and MAY have the optional properties listed in Table {counter:table-num}.
====
[#location-properties,reftext='{table-caption} {counter:table-num}']
.Properties of a Location entity
[width="100%",cols="5,17,3,3,3",options="header"]
|====
| *Name*
| *Definition*
| *Data Type*      | *Usage*  | *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating or updating the entity unless specified by the client.
| ANY              | Required | One

| `name`
| A property provides a label for Location entity, commonly a descriptive name.
| String           | Required | One

| `encodingType`
| The encoding type of the Location property.
| String           | Required | One

| `location`
| The identifiable location of the Thing
| ANY              | Required | One

| `description`
| The description about the Location
| String           | Optional | Zero-to-one

| `properties`
| A JSON Object containing user-annotated properties as key-value pairs.
| JSON Object      | Optional | Zero to One
|====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/location/relations
Each Location entity SHALL have the direct relation between a Location entity and other entity types listed in Table {counter:table-num}.
====

[#location-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between a Location entity and other entity types
[width="100%",cols="5,5,10,10",options="header"]
|====
| *Entity Name*        | *Role*              | *Multiplicity*
| *Description*

| `Thing`              | Things              | Many optional to many optional
| Multiple Things MAY locate at the same Location.
A Thing MAY not have a Location.

| `HistoricalLocation` | HistoricalLocations | Many optional to many optional
| A Location MAY have zero-to-many HistoricalLocations.
One HistoricalLocation SHALL have one or more Locations.
|====




[[historicallocation]]
==== HistoricalLocation

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/historical-location
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/historical-location/properties
requirement:: {identifier}/req/datamodel/sensing/historical-location/relations
requirement:: {identifier}/req/datamodel/sensing/historical-location/create-update-delete/historical-location-auto-creation
requirement:: {identifier}/req/datamodel/sensing/historical-location/create-update-delete/historical-location-manual-creation
====

A Thing’s HistoricalLocation entity set provides the times of the current (i.e., last known) and previous locations of the Thing.
It can be used to model the path observed by a moving Thing.

[example%unnumbered]
====
*HistoricalLocation Examples*

- A drone that measures methane leaks over a large basin may want to record the trajectory through which it flies.
HistoricalLocation should then record the individual Locations of the drone over time 

====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/historical-location/properties

Each HistoricalLocation entity SHALL have the mandatory properties and MAY have the optional properties listed in Table {counter:table-num}.
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/historical-location/relations

Each HistoricalLocation entity SHALL have the direct relation between a HistoricalLocation entity and other entity types listed in Table {counter:table-num}.
====

[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/historical-location/create-update-delete/historical-location-auto-creation

When a Thing has a new Location, a new HistoricalLocation SHALL be created and added to the Thing automatically by the service.
The current Location of the Thing SHALL only be added to this autogenerated HistoricalLocation automatically by the service, and SHALL not be created as HistoricalLocation directly by user.
====

The HistoricalLocation can also be created, updated and deleted.
One use case is to migrate historical observation data from an existing observation data management system to a SensorThings API system.
Another use case is to track the Location of a Thing, when a permanent network connection is not available.
If the Location of a Thing is changed at a later time, when a network connection is available again, then the auto-generated Time of the HistoricalLocation entity would not reflect the time when the Thing was actually at the set Location, but only the time at which the change was sent to the server.
To resolve this, the Location of a Thing can also be changed by adding a HistoricalLocation.
If the time of a manually created HistoricalLocation is later than the time of all existing HistoricalLocations, then the Location of the Thing is updated to the Location of this manually created HistoricalLocation.

[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/historical-location/create-update-delete/historical-location-manual-creation

When a user directly adds new HistoricalLocation, and the time of this new HistoricalLocation is later than the latest HistoricalLocation for the Thing, then the Locations of the Thing are changed to the Locations of this new HistoricalLocation.
====

[#historical-location-properties,reftext='{table-caption} {counter:table-num}']
.Properties of a HistoricalLocation entity
[width="100%",cols="5,17,3,3,3",options="header"]
|====
| *Name*
| *Definition*
| *Data Type* | *Usage*  | *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating or updating the entity unless specified by the client.
| ANY         | Required | One

| `time`
| The time when the Thing is known at the Location.
| TM_Instant  | Required | One
|====


[#historical-location-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between a HistoricalLocation entity and other entity types
[width="100%",cols="5,5,10,10",options="header"]
|====
| *Entity Name* | *Role*    | *Multiplicity*
| *Description*

| `Location`    | Locations | Many optional to many mandatory
| A Location can have zero-to-many HistoricalLocations.
One HistoricalLocation SHALL have one or many Locations.

| `Thing`       | Thing     | Many optional to one mandatory
| A HistoricalLocation has one-and-only-one Thing.
One Thing MAY have zero-to-many HistoricalLocations.
|====




[[datastream]]
==== Datastream

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/datastream
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/datastream/properties
requirement:: {identifier}/req/datamodel/sensing/datastream/relations
====

A Datastream groups a collection of Observations into a time series measuring the same ObservedProperty by the same Sensor for the same Feature for the same Thing.

[example%unnumbered]
====
*Datastream Examples*

- An air quality monitoring station may have multiple Datastreams each recording a specific pollutant measured by the sensors
- A sensor that measures multiple ObservedProperties can generate a single Datastream of composite resultTypes 

====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/datastream/properties

Each Datastream entity SHALL have the mandatory properties and MAY have the optional properties listed in Table {counter:table-num}.
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/datastream/relations

Each Datastream entity SHALL have the direct relation between a Datastream entity and other entity types listed in Table {counter:table-num}.
====



[#datastream-properties,reftext='{table-caption} {counter:table-num}']
.Properties of a Datastream entity
[width="100%",cols="5,17,3,3,3",options="header"]
|====
| *Name*
| *Definition*
| *Data Type*
| *Usage*  | *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating or updating the entity unless specified by the client
| ANY
| Required | One

| `name`
| A property provides a label for Datastream entity, commonly a descriptive name.
| String
| Required | One

| `description`
| The description of the Datastream entity.
| String
| Optional | Zero-to-one

| `resultType`
| The type of Observation (with unit of measurement AND unique result type), which is used by the service to encode observations
| JSON Object (SWE-Common AbstractDataComponent)
| Required | One

| `observedArea`
| The spatial bounding box of the spatial extent of the Feature that belong to the Observations associated with this Datastream
| Geometry
| Optional | Zero-to-one

| `phenomenonTime`
| The temporal interval of the phenomenon times of all observations belonging to this Datastream.
| TM_Period
| Optional | Zero-to-one

| `resultTime`
| The temporal interval of the result times of all observations belonging to this Datastream.
| TM_Period
| Optional | Zero-to-one

| `properties`
| A JSON Object containing user-annotated properties as key-value pairs.
| JSON Object
| Optional | Zero-to-one
|====


[#datastream-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between a Datastream entity and other entity types
[width="100%",cols="5,5,10,10",options="header"]
|====
| *Entity Name*      | *Role*                    | *Multiplicity*
| *Description*

| `Thing`            | Thing                     | Many optional to one mandatory
| A Thing has zero-to-many Datastreams.
A Datastream entity SHALL only link to a Thing as a collection of Observations

| `Sensor`           | Sensor                    | Many optional to one mandatory
| The Observations in a Datastream are performed by one-and-only-one Sensor.
One Sensor MAY produce zero-to-many Observations in different Datastreams.

| `ObservedProperty` | ObservedProperty          | Many optional to many mandatory
| The Observations of a Datastream SHALL observe the same ObservedProperty.
The Observations of different Datastreams MAY observe the same ObservedProperty

| `Observation`      | Observations              | One mandatory to many optional
| A Datastream has zero-to-many Observations.
One Observation SHALL occur in one-and-only-one Datastream

| `Feature`          | UltimateFeatureOfInterest | Many optional to one optional
| The Feature has the role UltimateFeatureOfInterest so that all the Observations in a Datastream pertain only to the same linked Feature
|====


The resultType defines the result types for specialized single and multi observations based on the JSON encoding of the SWE Common Data Model [OGC 08-094r1 and OGC 17-011r2].
This also obsoletes MultiDatastreams as the same information can be described using the SWE Common definition types.


.Example {counter:examples}: A Datastream example measuring a scalar Observation
[source%unnumbered,json]
----
{
  "id": 42,
  "name": "Oven temperature",
  "description": "This is a datastream measuring the air temperature in an oven.",
  "resultType": {
    "type": "Quantity",
    "definition": "http://mmisw.org/ont/cf/parameter/air_temperature",
    "uom": { "code": "Cel", "label": "degree Celsius", "symbol": "°C" }
  }
}
----

.Example {counter:examples}: An Observation for the Datastream defined in the example above
[source%unnumbered,json]
----
{
  "result": 25.1,
  "phenomenonTime": "2021-13-14T15:16:00Z",
  "resultTime": null
}
----


.Example {counter:examples}: A Datastream example for Observations with category values from a predefined code space
[source%unnumbered,json]
----
{
  "id": 43,
  "name": "Sample Datings",
  "description": "This is a datastream containing the geological datings of rock samples.",
  "resultType": {
    "type": "Category",
    "definition": "http://sweet.jpl.nasa.gov/2.0/timeGeologic.owl#GeologicTime",
    "codeSpace": "http://sweet.jpl.nasa.gov/2.0/timeGeologic.owl#Era"
  }
}
----

.Example {counter:examples}: An Observation for a Datastream defined in the example above
[source%unnumbered,json]
----
{
  "result": "Jurassic",
  "phenomenonTime": "2021-13-14T15:16:00Z",
  "resultTime": null
}
----


.Example {counter:examples}: A Datastream example measuring multiple observedProperties
[source%unnumbered,json]
----
{
  "id": 43,
  "name": "Temperature and Pressure",
  "description": "This is a datastream containing temperature and pressure measurement sets.",
  "resultType": {
    "type": "DataRecord",
    "name": "Measurement set",
    "fields": [
      {
        "name": "temp",
        "type": "Quantity",
        "definition": "http://mmisw.org/ont/cf/parameter/air_temperature",
        "label": "Air Temperature",
        "uom": { "code": "Cel", "label": "degree Celsius", "symbol": "°C"  }
      },
      {
        "name": "press",
        "type": "Quantity",
        "definition": "http://mmisw.org/ont/cf/parameter/air_pressure_at_mean_sea_level",
        "label": "Air Pressure",
        "uom": { "code": "mbar", "label": "Millibar", "symbol": "mBar"  }
      }
    ]
  }
}
----

.Example {counter:examples}: An Observation for a Datastream defined in the example above
[source%unnumbered,json]
----
{
  "result": {"temp": 15, "press": 1024},
  "phenomenonTime": "2021-13-14T15:16:00Z",
  "resultTime": null
}
----



[[sensor]]
==== Sensor

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/sensor
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/sensor/properties
requirement:: {identifier}/req/datamodel/sensing/sensor/relations
====

A Sensor is an instrument that observes a property or phenomenon with the goal of producing an estimate of the value of the property


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/sensor/properties

Each Sensor entity SHALL have the mandatory properties and MAY have the optional properties listed in Table {counter:table-num}.
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/sensor/relations

Each Sensor entity SHALL have the direct relation between a Sensor entity and other entity types listed in Table {counter:table-num}.
====


[#sensor-properties,reftext='{table-caption} {counter:table-num}']
.Properties of a Sensor entity
[width="100%",cols="5,17,3,3,3",options="header"]
|====
| *Name*
| *Definition*
| *Data Type* | *Usage*  | *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating or updating the entity unless specified by the client.
| ANY         | Required | One

| `name`
| A property provides a label for Sensor entity, commonly a descriptive name.
| String      | Required | One
| `description`
| The description of the Sensor entity.
| String      | Optional | Zero-to-one

| `encodingType`
| The encoding type of the metadata property.
Its value is one of the ValueCode enumeration (see <<sensor-encodingType-value-codes>> for the available ValueCode)
| ValueCode   | Required | One

| `metadata`
| The detailed description of the Sensor or system.
The metadata type is defined by encodingType.
| String      | Required | One

| `properties`
| A JSON Object containing user-annotated properties as key-value pairs
| JSON Object | Optional | Zero-to-one
|====


[#sensor-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between a Sensor entity and other entity types
[width="100%",cols="5,5,10,10",options="header"]
|====
| *Entity Name*               | *Role*                                 | *Multiplicity*                   | *Description*
| `Datastream`                | Datastreams                            | One mandatory to many optional   | The Observations of a Datastream are measured with the same Sensor. One Sensor MAY produce zero-to-many Observations in different Datastreams
|====


[#sensor-encodingType-value-codes,reftext='{table-caption} {counter:table-num}']
.List of some code values used for identifying types for the encodingType of the Sensor entity
[width="100%",cols="15,5",options="header"]
|====
| *Sensor encodingType*                | *ValueCode Value*              
| `PDF`                                | application/pdf                                  
| `SensorML`                           | http://www.opengis.net/doc/IS/SensorML/2.0
| `HTML`                               | text/html
|====

The Sensor encodingType allows clients to know how to interpret metadata’s value.
Currently SensorThings API defines two common Sensor metadata encodingTypes.
Most sensor manufacturers provide their sensor datasheets in a PDF format.
As a result, PDF is a Sensor encodingType supported by SensorThings API.
The second Sensor encodingType is SensorML.
Lastly, some sensor datasheets are HTML documents rather than PDFs.
Other encodingTypes are permitted (e.g., text/plain).
Note that the metadata property may contain either a URL to metadata content (e.g., an https://, ftp://, etc. link to a PDF, SensorML, or HTML document) or the metadata content itself (in the case of text/plain or other encodingTypes that can be represented as valid JSON).
It is up to clients to perform string parsing necessary to properly handle metadata content.

[[observedproperty]]
==== ObservedProperty

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/observed-property
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/observed-property/properties
requirement:: {identifier}/req/datamodel/sensing/observed-property/relations
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/observed-property/properties

Each ObservedProperty entity SHALL have the mandatory properties and MAY have the optional properties listed in Table {counter:table-num}.
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/observed-property/relations

Each ObservedProperty entity SHALL have the direct relation between an ObservedProperty entity and other entity types listed in Table {counter:table-num}.
====


[#observed-property-properties,reftext='{table-caption} {counter:table-num}']
.Properties of an ObservedProperty entity
[width="100%",cols="5,17,3,3,3",options="header"]
|====
| *Name*
| *Definition*
| *Data Type* | *Usage*  | *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating or updating the entity unless specified by the client.
| ANY          | Required | One

| `name`
| A property provides a label for ObservedProperty  entity, commonly a descriptive name.
| String       | Required | One

| `definition`
| The URI of the ObservedProperty.
Dereferencing this URI SHOULD result in a representation of the definition of the ObservedProperty
| URI          | Required | One

| `description`
| A description about the ObservedProperty.
| String       | Optional | Zero-to-one

| `properties`
| A JSON Object containing user-annotated properties as key-value pairs
| JSON Object  | Optional | Zero-to-one
|====


[#observed-property-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between an ObservedProperty entity and other entity types
[width="100%",cols="5,5,10,10",options="header"]
|====
| *Entity Name* | *Role*      | *Multiplicity*
| *Description*
| `Datastream`  | Datastreams | One mandatory to many optional   
| The Observations of a Datastream observe the same ObservedProperty.
The Observations of different Datastreams MAY observe the same ObservedProperty.
|====




[[observation]]
==== Observation

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/observation
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/observation/properties
requirement:: {identifier}/req/datamodel/sensing/observation/relations
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/observation/properties

Each Observation entity SHALL have the mandatory properties and MAY have the optional properties listed in Table {counter:table-num}.
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/observation/relations

Each Observation entity SHALL have the direct relation between an Observation entity and other entity types listed in Table {counter:table-num}.
====


[#observation-properties,reftext='{table-caption} {counter:table-num}']
.Properties of an Observation entity
[width="100%",cols="5,17,3,3,3",options="header"]
|====
| *Name*
| *Definition*
| *Data Type* | *Usage*  | *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating or updating the entity unless specified by the client.
| ANY         | Required | One

| `phenomenonTime`
| The time instant or period of when the Observation happens.

Note: Many resource-constrained sensing devices do not have a clock.
As a result, a client may omit phenomenonTime when POST new Observations, even though phenomenonTime is a mandatory property.
When a SensorThings service receives a POST Observations without phenomenonTime, the service SHALL assign the current server time to the value of the phenomenonTime
| TM_Object   | Optional | Zero-to-one

| `result`
| The estimated value of an ObservedProperty from the Observation.
| ANY         | Required | One
| `resultTime`
| The time of the Observation’s result was generated

Note: Many resource-constrained sensing devices do not have a clock.
As a result, a client may omit resultTime when POST new Observations, even though resultTime is a mandatory property.
When a SensorThings service receives a POST Observations without resultTime, the service SHALL assign a null value to the resultTime.
| TM_Instant  | Optional | Zero-to-one

| `validTime`
| The time period during which the result may be used
| TM_Period   | Optional | Zero-to-one

| `properties`
| A JSON Object containing user-annotated properties as key-value pairs (usually showing the environmental conditions during measurement)
| JSON Object | Optional | Zero-to-one
|====


[#observation-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between an Observation entity and other entity types
[width="100%",cols="5,5,10,10",options="header"]
|====
| *Entity Name* | *Role*                     | *Multiplicity*
| *Description*

| `Datastream`  | Datastream                 | Many optional to one mandatory
| A Datastream can have zero-to-many Observations.
One Observation SHALL occur in one-and-only-one Datastream

| `Feature`     | ProximateFeatureOfInterest | Many optional to one optional
| The Feature observed by the Observation.
The relationship is optional and SHALL exist in cases where the observed Feature is a proxy of the actual Feature
|====

[additional-notes]
====
*NOTE*: For an Observation, either the direct ProximateFeatureOfInterest or the indirect UltimateFeatureOfInterest SHALL exist.
====


[[feature]]
==== Feature

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/feature
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/feature/properties
requirement:: {identifier}/req/datamodel/sensing/feature/relations
====

An Observation assigns a value to a property of a subject by applying an ObservingProcedure.
The subject is the Feature that can take the role of ProximateFeatureOfInterest or ultimateFeatureOfInterest of the Observation [OGC 20-082r4 and ISO 19156:2023].
In cases where estimating the value of a property of interest is not possible directly, a proxy feature MAY be used.
Such an application typically requires Sampling the UltimateFeatureOfInterest such that the observed Feature represents an approximation of the domain feature.
In many sensing applications, the Observations’ Feature can be ambiguous with the Location of the Thing.
Thus the concept of roles is introduced to better describe the relationship between an Observation and it's Feature.

[example%unnumbered]
====
*Feature Examples*


- The Feature of a WiFi enabled thermostat can be the Location of the thermostat (i.e., the living room where the thermostat is located in).
However, in such cases, it is recommended to use the Location entity to store this information while the Feature entity (with the role of proximateFeatureOfInterest) can be used to model the ambient indoor atmosphere around the thermostat that approximates the overall room's temperature.

- In the case of remote sensing, the Feature observed can be the individual geographical parcel or swath that is being sensed, while the Location entity can maintain the larger geographical region that is being monitored.
====

[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/feature/properties

Each Feature entity SHALL have the mandatory properties and MAY have the optional properties listed in Table {counter:table-num}.
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/feature/relations

Each Feature entity SHALL have the direct relation between a Feature entity and other entity types listed in Table {counter:table-num}.
====


[#feature-properties,reftext='{table-caption} {counter:table-num}']
.Properties of a Feature entity
[width="100%",cols="5,17,3,3,3",options="header"]
|====
| *Name*
| *Definition*
| *Data Type* | *Usage*  | *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating or updating the entity unless specified by the client.
| ANY         | Required | One

| `name`
| A property provides a label for Feature entity, commonly a descriptive name.
| String      | Required | One

| `description`
| The description about the Feature
| String      | Optional | Zero-to-one

| `encodingType`
| The encoding type of the feature property
| String      | Required | One

| `feature`
| The detailed description of the feature.
The data type is defined by encodingType.
| ANY         | Required | Zero-to-one

| `properties`
| A JSON Object containing user-annotated properties as key-value pairs
| JSON Object | Optional | Zero-to-one
|====


[#feature-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between a Feature entity and other entity types
[width="100%",cols="5,5,10,10",options="header"]
|====
| *Entity Name* | *Role*       | *Multiplicity*                
| *Description*

| `Observation` | Observations | One optional to many optional
| A Feature MAY have zero-to-many Observations.
An Observation SHOULD observe at most one Feature

| `Datastream`  | Datastreams  | One optional to many optional
| There MAY be multiple Datastreams observing the same Feature as a Feature MAY have multiple properties of interest.
However a Datastream SHOULD link to at most one Feature of interest.
|====
