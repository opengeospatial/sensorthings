[[sensing-core]]
== The SensorThings API Data Model

All data model requirements classes are grouped in the following requirements class:


[requirements_class]
.Sensing Entities

====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req-class/datamodel/sensing/thing
requirement:: {identifier}/req-class/datamodel/sensing/location
requirement:: {identifier}/req-class/datamodel/sensing/historical-location
requirement:: {identifier}/req-class/datamodel/sensing/datastream
requirement:: {identifier}/req-class/datamodel/sensing/sensor
requirement:: {identifier}/req-class/datamodel/sensing/observed-property
requirement:: {identifier}/req-class/datamodel/sensing/observation
requirement:: {identifier}/req-class/datamodel/sensing/feature  
====

The OGC SensorThings API v2.0 depicts the Core Sensing entities in <<img-sta-core>>
[#img-sta-core,link=figures/Datamodel-SensorThingsApi-V2-Core.drawio.png, reftext='{figure-caption} {counter:figure-num}', title='Sensing Core']
image::figures/Datamodel-SensorThingsApi-V2-Core.drawio.png[Sensing Core, align="center"]  




In this section, we define each entity depicted in <<img-sta-core>> and its relationships with other entities.
Additionally, we also provide examples to model the entities in different contexts.

[[thing]]
=== Thing

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/thing
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/thing/properties
requirement:: {identifier}/req/datamodel/sensing/thing/relations
====

The SensorThings API follows the ITU-T definition, i.e., with regard to the Internet of Things, a thing is an object of the physical world (physical things) or the information world (virtual things) that is capable of being identified and integrated into communication networks [ITU-T Y.2060].
A Thing is related to the Platform entity as described in Section 4.9.2.1 of [OGC 16-079] in a way that any entity that can be modelled as a Thing MAY be subsequently translated to a Platform and vice versa.

The SensorThings API follows the ITU-T definition, i.e., with regard to the Internet of Things, a thing is an object of the physical world (physical things) or the information world (virtual things) that is capable of being identified and integrated into communication networks [ITU-T Y.2060].
A Thing is related to the Platform entity as described in Section 4.9.2.1 of [OGC 16-079] in a way that any entity that can be modelled as a Thing MAY be subsequently translated to a Platform and vice versa.

[example%unnumbered]
====
*Thing Examples*

- A weather station that houses a varying set of environmental sensors
- A drone that mounts a LiDAR sensor for mapping purposes
- A science vessel that has many sensors installed
- An upstream oil well that is equipped with compound gas detection devices
====

[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/thing/properties

Each Thing entity SHALL have the mandatory properties and MAY have the optional properties listed in <<thing-properties>>.
====

[#thing-properties,reftext='{table-caption} {counter:table-num}']
.Properties of a Thing entity
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Name*
| *Definition*
| *Data Type*
| *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating  the entity unless specified by the client.
| ANY
| 1

| `name`
| A property provides a label for Thing entity, commonly a descriptive name.
| String
| 1

| `description`
| This is a short description of the corresponding Thing entity.
| String
| 0..1

| `properties`
| A JSON Object containing user-annotated properties.
| JSON Object
| 0..1
|====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/thing/relations

Each Thing entity SHALL have the direct relation between a Thing entity and other entity types listed in <<thing-relations>>.
====

[#thing-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between a Thing entity and other entity types
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Role*
| *Description*
| *Target Entity Type*
| *Multiplicity*

| `Location`
| The Location entity locates the Thing.
Multiple Things MAY be located at the same Location.
A Thing MAY not have a Location.
A Thing SHOULD have only one Location.

However, in some complex use cases, a Thing MAY have more than one Location representations.
In such case, the Thing MAY have more than one Locations.
| `Location`
| 0..1

| `HistoricalLocations`
| A Thing has zero-to-many HistoricalLocations.
A HistoricalLocation has one-and-only-one Thing.
| `HistoricalLocation`
| 0..*

| `Datastreams`
| A Thing MAY have zero-to-many Datastreams.
| `Datastream`
| 0..*
|====





[[location]]
=== Location

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/location
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/location/properties
requirement:: {identifier}/req/datamodel/sensing/location/relations
====

The Location entity geo-locates the Thing or the Things it associated with.
A Thing’s Location entity is defined as the last known location of the Thing.

The Feature can be either a proximate feature of interest or the ultimate feature of interest depending upon the context of the Observation.
For __in-situ__ sensing applications, the Location MAY describe the coordinates of where the Thing is located.
The Feature is the entity for which the value of a property was determined by the Sensor.
The ObservedProperty in this case MAY characterize only the area around the sensing device or it MAY characterize the larger observedArea that the sensing application intends to capture.
Thus, depending upon the feature-of-interest, the Feature can then be either a ProximateFeatureOfInterest or UltimateFeatureOfInterest.
For __ex-situ__ sensing applications, the Location MAY describe the coordinates of where the Thing is located, whereas the feature MAY be the point location of the observed Feature.

EDITOR: Explain all 4 possible options? in-situ, local; in-site, remote; ex-situ, local; ex-situ, remote

Section 7.1.4 of [OGC 20-082r4 and ISO 19156:2023] provides a detailed explanation of observation location.

[example%unnumbered]
====
*Location Examples*

- An air quality sensing facility's Location can be the physical location where the facility is situated, but the (proximate) Feature that is characterized by the Observation could be the air envelope around the Sensor which is subsequently used to estimate the air quality of the district where the facility is situated.
- A drone that mounts a LiDAR Sensor may have its Location as the geo-referenced area over which the drone is scheduled to fly, whereas the Feature could be the individual objects mapped by the Sensor within that geo-referenced area
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/location/properties

Each Location entity SHALL have the mandatory properties and MAY have the optional properties listed in <<location-properties>>.
====

[#location-properties,reftext='{table-caption} {counter:table-num}']
.Properties of a Location entity
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Name*
| *Definition*
| *Data Type*
| *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating  the entity unless specified by the client.
| ANY
| 1

| `name`
| A property provides a label for Location entity, commonly a descriptive name.
| String
| 1

| `encodingType`
| The encoding type of the Location property.
| String
| 1

| `location`
| The identifiable location of the Thing
| ANY
| 1

| `description`
| The description about the Location
| String
| 0..1

| `properties`
| A JSON Object containing user-annotated properties.
| JSON Object
| 0..1
|====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/location/relations

Each Location entity SHALL have the direct relation between a Location entity and other entity types listed in <<location-relations>>.
====

[#location-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between a Location entity and other entity types
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Role*
| *Description*
| *Target Entity Type*
| *Multiplicity*

| `Things`
| The Things located at the source Location.
Multiple Things MAY locate at the same Location.
| `Thing`
| 0..*

| `HistoricalLocations`
| The HistoricalLocations of things that have been located at this Location.
| `HistoricalLocation`
| 0..*
|====



[[historicallocation]]
=== HistoricalLocation

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/historical-location
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/historical-location/properties
requirement:: {identifier}/req/datamodel/sensing/historical-location/relations
requirement:: {identifier}/req/datamodel/sensing/historical-location/create-update-delete/historical-location-auto-creation
requirement:: {identifier}/req/datamodel/sensing/historical-location/create-update-delete/historical-location-manual-creation
====

A Thing's HistoricalLocation entity set provides the times of the current (i.e., last known) and previous locations of the Thing.
It can be used to model the path observed by a moving Thing.

[example%unnumbered]
====
*HistoricalLocation Examples*

- A drone that measures methane leaks over a large basin may want to record the trajectory through which it flies.
HistoricalLocation should then record the individual Locations of the drone over time 

====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/historical-location/properties

Each HistoricalLocation entity SHALL have the mandatory properties and MAY have the optional properties listed in <<historical-location-properties>>.
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/historical-location/relations

Each HistoricalLocation entity SHALL have the direct relation between a HistoricalLocation entity and other entity types listed in <<historical-location-relations>>.
====

[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/historical-location/create-update-delete/historical-location-auto-creation

When a Thing has a new Location, a new HistoricalLocation SHALL be created and added to the Thing automatically by the service.
The current Location of the Thing SHALL only be added to this autogenerated HistoricalLocation automatically by the service, and SHALL not be created as HistoricalLocation directly by user.
====

The HistoricalLocation can also be created, updated and deleted.
One use case is to migrate historical observation data from an existing observation data management system to a SensorThings API system.
Another use case is to track the Location of a Thing, when a permanent network connection is not available.
If the Location of a Thing is changed at a later time, when a network connection is available again, then the auto-generated Time of the HistoricalLocation entity would not reflect the time when the Thing was actually at the set Location, but only the time at which the change was sent to the server.
To resolve this, the Location of a Thing can also be changed by adding a HistoricalLocation.
If the time of a manually created HistoricalLocation is later than the time of all existing HistoricalLocations, then the Location of the Thing is updated to the Location of this manually created HistoricalLocation.

[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/historical-location/create-update-delete/historical-location-manual-creation

When a user directly adds new HistoricalLocation, and the time of this new HistoricalLocation is later than the latest HistoricalLocation for the Thing, then the Locations of the Thing are changed to the Locations of this new HistoricalLocation.
====

[#historical-location-properties,reftext='{table-caption} {counter:table-num}']
.Properties of a HistoricalLocation entity
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Name*
| *Definition*
| *Data Type*
| *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating  the entity unless specified by the client.
| ANY
| 1

| `time`
| The time when the Thing is known at the Location.
| TM_Instant
| 1
|====


[#historical-location-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between a HistoricalLocation entity and other entity types
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Role*
| *Description*
| *Target Entity Type*
| *Multiplicity*

| Locations
| The Locations for this HistoricalLocation.
One HistoricalLocation SHALL have at least one Location.
| `Location`
| 1..*

| Thing
| The Thing this HistoricalLocation positions in time.
A HistoricalLocation has exactly one Thing.
| `Thing`
| 1
|====




[[datastream]]
=== Datastream

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/datastream
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/datastream/properties
requirement:: {identifier}/req/datamodel/sensing/datastream/relations
====

A Datastream groups a collection of Observations into a time series measuring the same ObservedProperty by the same Sensor for the same Feature for the same Thing.

[example%unnumbered]
====
*Datastream Examples*

- An air quality monitoring station may have multiple Datastreams each recording a specific pollutant measured by the sensors
- A sensor that measures multiple ObservedProperties can generate a single Datastream of composite resultTypes 

====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/datastream/properties

Each Datastream entity SHALL have the mandatory properties and MAY have the optional properties listed in <<datastream-properties>>.
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/datastream/relations

Each Datastream entity SHALL have the direct relation between a Datastream entity and other entity types listed in <<datastream-relations>>.
====



[#datastream-properties,reftext='{table-caption} {counter:table-num}']
.Properties of a Datastream entity
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Name*
| *Definition*
| *Data Type*
| *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating  the entity unless specified by the client
| ANY
| 1

| `name`
| A property provides a label for Datastream entity, commonly a descriptive name.
| String
| 1

| `description`
| The description of the Datastream entity.
| String
| 0..1

| `resultType`
| The formal description of the `result` field of the Observations in this Datastream.
Contains the unit of measurement.
| JSON Object (SWE-Common AbstractDataComponent)
| 1

| `observedArea`
| The spatial bounding box of the spatial extent of the Feature that belong to the Observations associated with this Datastream.
This is usually generated by the server.
| Geometry
| 0..1

| `phenomenonTime`
| The temporal interval of the phenomenon times of all observations belonging to this Datastream.
This is usually generated by the server.
| TM_Period
| 0..1

| `resultTime`
| The temporal interval of the result times of all observations belonging to this Datastream.
This is usually generated by the server.
| TM_Period
| 0..1

| `properties`
| A JSON Object containing user-annotated properties.
| JSON Object
| 0..1
|====


[#datastream-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between a Datastream entity and other entity types
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Role*
| *Description*
| *Target Entity Type*
| *Multiplicity*

| `Thing`
| The Thing this Datastream holds Observations for.
| `Thing`
| 1

| `Sensor`
| The Sensor that made the Observations in this Datastream.
| `Sensor`
| 1

| `ObservedProperty`
| The ObservedProperty of the Observations in this Datastream.
The Observations in a Datastream may hold values for multiple ObservedProperties, but the ObservedProperties are the same for all Observations in the same Datastream.
See `resultType` for the details on the encoding of results.
| `ObservedProperty`
| 1..*

| `Observations`
| The Observations for a Datastream.
| `Observation`
| 0..*

| `UltimateFeatureOfInterest`
| The Feature has the role UltimateFeatureOfInterest so that all the Observations in a Datastream pertain only to the same linked Feature
| `Feature`
| 0..1
|====


The resultType defines the result types for specialized single and multi observations based on the JSON encoding of the SWE Common Data Model [OGC 08-094r1 and OGC 17-011r2].
The result of an Observation may be a single simple number or String, or it may contain a complex JSON structure holding multiple values for multiple ObservedProperties.
The exact definition for this result structure, and which unit of measurement and which ObservedProperty pertains to each value in the result structure is exactly described by this resultType Object.



.Example {counter:examples}: A Datastream example measuring a scalar Observation
[source%unnumbered,json]
----
{
  "id": 42,
  "name": "Oven temperature",
  "description": "This is a datastream measuring the air temperature in an oven.",
  "resultType": {
    "type": "Quantity",
    "definition": "http://mmisw.org/ont/cf/parameter/air_temperature",
    "uom": { "code": "Cel", "label": "degree Celsius", "symbol": "°C" }
  }
}
----

.Example {counter:examples}: An Observation for the Datastream defined in the example above
[source%unnumbered,json]
----
{
  "result": 25.1,
  "phenomenonTime": "2021-13-14T15:16:00Z",
  "resultTime": null
}
----


.Example {counter:examples}: A Datastream example for Observations with category values from a predefined code space
[source%unnumbered,json]
----
{
  "id": 43,
  "name": "Sample Datings",
  "description": "This is a datastream containing the geological datings of rock samples.",
  "resultType": {
    "type": "Category",
    "definition": "http://sweet.jpl.nasa.gov/2.0/timeGeologic.owl#GeologicTime",
    "codeSpace": "http://sweet.jpl.nasa.gov/2.0/timeGeologic.owl#Era"
  }
}
----

.Example {counter:examples}: An Observation for a Datastream defined in the example above
[source%unnumbered,json]
----
{
  "result": "Jurassic",
  "phenomenonTime": "2021-13-14T15:16:00Z",
  "resultTime": null
}
----


.Example {counter:examples}: A Datastream example measuring multiple observedProperties
[source%unnumbered,json]
----
{
  "id": 43,
  "name": "Temperature and Pressure",
  "description": "This is a datastream containing temperature and pressure measurement sets.",
  "resultType": {
    "type": "DataRecord",
    "name": "Measurement set",
    "fields": [
      {
        "name": "temp",
        "type": "Quantity",
        "definition": "http://mmisw.org/ont/cf/parameter/air_temperature",
        "label": "Air Temperature",
        "uom": { "code": "Cel", "label": "degree Celsius", "symbol": "°C"  }
      },
      {
        "name": "press",
        "type": "Quantity",
        "definition": "http://mmisw.org/ont/cf/parameter/air_pressure_at_mean_sea_level",
        "label": "Air Pressure",
        "uom": { "code": "mbar", "label": "Millibar", "symbol": "mBar"  }
      }
    ]
  }
}
----

.Example {counter:examples}: An Observation for a Datastream defined in the example above
[source%unnumbered,json]
----
{
  "result": {"temp": 15, "press": 1024},
  "phenomenonTime": "2021-13-14T15:16:00Z",
  "resultTime": null
}
----



[[sensor]]
=== Sensor

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/sensor
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/sensor/properties
requirement:: {identifier}/req/datamodel/sensing/sensor/relations
====

A Sensor is an instrument that observes a property or phenomenon with the goal of producing an estimate of the value of the property


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/sensor/properties

Each Sensor entity SHALL have the mandatory properties and MAY have the optional properties listed in <<sensor-properties>>.
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/sensor/relations

Each Sensor entity SHALL have the direct relation between a Sensor entity and other entity types listed in <<sensor-relations>>.
====


[#sensor-properties,reftext='{table-caption} {counter:table-num}']
.Properties of a Sensor entity
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Name*
| *Definition*
| *Data Type*
| *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating  the entity unless specified by the client.
| ANY
| 1

| `name`
| A property provides a label for Sensor entity, commonly a descriptive name.
| String
| 1
| `description`
| The description of the Sensor entity.
| String
| 0..1

| `encodingType`
| The encoding type of the metadata property.
Its value is one of the ValueCode enumeration (see <<sensor-encodingType-value-codes>> for the available ValueCode)
| ValueCode
| 1

| `metadata`
| The detailed description of the Sensor or system.
The metadata type is defined by encodingType.
| String
| 1

| `properties`
| A JSON Object containing user-annotated properties as key-value pairs
| JSON Object
| 0..1
|====


[#sensor-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between a Sensor entity and other entity types
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Role*
| *Description*
| *Target Entity Type*
| *Multiplicity*

| `Datastreams`
| The Datastreams that hold Observations produced by this Sensor.
| `Datastream`
| 0..*
|====


[#sensor-encodingType-value-codes,reftext='{table-caption} {counter:table-num}']
.List of some code values used for identifying types for the encodingType of the Sensor entity
[width="100%",cols="15,5",options="header"]
|====
| *Sensor encodingType*
| *ValueCode Value*              

| `PDF`
| application/pdf                                  

| `SensorML`
| http://www.opengis.net/doc/IS/SensorML/2.0

| `HTML`
| text/html
|====

EDITOR: Ensure wording that List is not exhaustive!


The Sensor encodingType allows clients to know how to interpret the metadata value.
Currently SensorThings API defines two common Sensor metadata encodingTypes.
Most sensor manufacturers provide their sensor datasheets in a PDF format.
As a result, PDF is a Sensor encodingType supported by SensorThings API.
The second Sensor encodingType is SensorML.
Lastly, some sensor datasheets are HTML documents rather than PDFs.
Other encodingTypes are permitted (e.g., text/plain).
Note that the metadata property may contain either a URL to metadata content (e.g., an https://, ftp://, etc. link to a PDF, SensorML, or HTML document) or the metadata content itself (in the case of text/plain or other encodingTypes that can be represented as valid JSON).
It is up to clients to perform string parsing necessary to properly handle metadata content.

[[observedproperty]]
=== ObservedProperty

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/observed-property
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/observed-property/properties
requirement:: {identifier}/req/datamodel/sensing/observed-property/relations
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/observed-property/properties

Each ObservedProperty entity SHALL have the mandatory properties and MAY have the optional properties listed in <<observed-property-properties>>.
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/observed-property/relations

Each ObservedProperty entity SHALL have the direct relation between an ObservedProperty entity and other entity types listed in <<observed-property-relations>>.
====


[#observed-property-properties,reftext='{table-caption} {counter:table-num}']
.Properties of an ObservedProperty entity
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Name*
| *Definition*
| *Data Type*
| *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating  the entity unless specified by the client.
| ANY
| 1

| `name`
| A property provides a label for ObservedProperty  entity, commonly a descriptive name.
| String
| 1

| `definition`
| The URI of the ObservedProperty.
Dereferencing this URI SHOULD result in a representation of the definition of the ObservedProperty
| URI
| 1

| `description`
| A description about the ObservedProperty.
| String
| 0..1

| `properties`
| A JSON Object containing user-annotated properties as key-value pairs
| JSON Object
| 0..1
|====


[#observed-property-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between an ObservedProperty entity and other entity types
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Role*
| *Description*
| *Target Entity Type*
| *Multiplicity*

| `Datastreams`
| Datastreams that hold Observations that observed this ObservedProperty.
| `Datastream`
| 0..*
|====




[[observation]]
=== Observation

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/observation
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/observation/properties
requirement:: {identifier}/req/datamodel/sensing/observation/relations
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/observation/properties

Each Observation entity SHALL have the mandatory properties and MAY have the optional properties listed in <<observation-properties>>.
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/observation/relations

Each Observation entity SHALL have the direct relation between an Observation entity and other entity types listed in <<observation-relations>>.
====


[#observation-properties,reftext='{table-caption} {counter:table-num}']
.Properties of an Observation entity
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Name*
| *Definition*
| *Data Type*
| *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating  the entity unless specified by the client.
| ANY
| 1

| `phenomenonTime`
| The time instant or period of when the Observation happens.

Note: Many resource-constrained sensing devices do not have a clock.
As a result, a client may omit phenomenonTime when POST new Observations, even though phenomenonTime is a mandatory property.
When a SensorThings service receives a POST Observations without phenomenonTime, the service SHALL assign the current server time to the value of the phenomenonTime
| TM_Object
| 0..1

| `result`
| The estimated value of an ObservedProperty from the Observation.
| ANY
| 1
| `resultTime`
| The time of the Observation’s result was generated

Note: Many resource-constrained sensing devices do not have a clock.
As a result, a client may omit resultTime when POST new Observations, even though resultTime is a mandatory property.
When a SensorThings service receives a POST Observations without resultTime, the service SHALL assign a null value to the resultTime.
| TM_Instant
| 0..1

| `validTime`
| The time period during which the result may be used
| TM_Period
| 0..1

| `properties`
| A JSON Object containing user-annotated properties as key-value pairs (usually showing the environmental conditions during measurement)
| JSON Object
| 0..1
|====


[#observation-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between an Observation entity and other entity types
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Role*
| *Description*
| *Target Entity Type*
| *Multiplicity*

| `Datastream`
| The Datastream this Observation exists in.
| `Datastream`
| 1

| `ProximateFeatureOfInterest`
| The Feature observed by the Observation.
The relationship is optional and SHALL exist in cases where the observed Feature is a proxy of the actual Feature
| `Feature`
| 0..1
|====

[additional-notes]
====
*NOTE*: For an Observation, either the direct ProximateFeatureOfInterest or the indirect UltimateFeatureOfInterest SHALL exist.
====


[[feature]]
=== Feature

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/feature
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/feature/properties
requirement:: {identifier}/req/datamodel/sensing/feature/relations
====

An Observation assigns a value to a property of a subject by applying an ObservingProcedure.
The subject is the Feature that can take the role of ProximateFeatureOfInterest or ultimateFeatureOfInterest of the Observation [OGC 20-082r4 and ISO 19156:2023].
In cases where estimating the value of a property of interest is not possible directly, a proxy feature MAY be used.
Such an application typically requires Sampling the UltimateFeatureOfInterest such that the observed Feature represents an approximation of the domain feature.
In many sensing applications, the Observations’ Feature can be ambiguous with the Location of the Thing.
Thus the concept of roles is introduced to better describe the relationship between an Observation and it's Feature.

[example%unnumbered]
====
*Feature Examples*


- The Feature of a WiFi enabled thermostat can be the Location of the thermostat (i.e., the living room where the thermostat is located in).
However, in such cases, it is recommended to use the Location entity to store this information while the Feature entity (with the role of proximateFeatureOfInterest) can be used to model the ambient indoor atmosphere around the thermostat that approximates the overall room's temperature.

- In the case of remote sensing, the Feature observed can be the individual geographical parcel or swath that is being sensed, while the Location entity can maintain the larger geographical region that is being monitored.
====

[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/feature/properties

Each Feature entity SHALL have the mandatory properties and MAY have the optional properties listed in <<feature-properties>>.
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/feature/relations

Each Feature entity SHALL have the direct relation between a Feature entity and other entity types listed in <<feature-relations>>.
====


[#feature-properties,reftext='{table-caption} {counter:table-num}']
.Properties of a Feature entity
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Name*
| *Definition*
| *Data Type*
| *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating  the entity unless specified by the client.
| ANY
| 1

| `name`
| A property provides a label for Feature entity, commonly a descriptive name.
| String
| 1

| `description`
| The description about the Feature
| String
| 0..1

| `encodingType`
| The encoding type of the feature property
| String
| 1

| `feature`
| The detailed description of the feature.
The data type is defined by encodingType.
| ANY
| 0..1

| `properties`
| A JSON Object containing user-annotated properties as key-value pairs
| JSON Object
| 0..1
|====


[#feature-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between a Feature entity and other entity types
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Role*
| *Description*
| *Target Entity Type*
| *Multiplicity*                

| `Observations`
| All Observations that are made on this Feature
| `Observation`
| 0..*

| `Datastreams`
| All Datastreams that contain Observations relevant for this Feature.
| `Datastream`
| 0..*
|====




[[featuretype]]
=== FeatureType

[requirements_class]
====
[%metadata]
identifier:: {identifier}/req-class/datamodel/sensing/feature-type
obligation:: requirement
subject:: Target Type: Data Model
requirement:: {identifier}/req/datamodel/sensing/feature-type/properties
requirement:: {identifier}/req/datamodel/sensing/feature-type/relations
====

The type or types of each Feature can be specified using the FeatureType class.
The `definition` attribute of the FeatureType should point to an external registry or code list, that defines the Type.


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/feature-type/properties

Each FeatureType entity SHALL have the mandatory properties and MAY have the optional properties listed in <<feature-type-properties>>.
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/datamodel/sensing/feature-type/relations

Each FeatureType entity SHALL have the direct relation between a FeatureType entity and other entity types listed in <<feature-type-relations>>.
====


[#feature-type-properties,reftext='{table-caption} {counter:table-num}']
.Properties of a FeatureType entity
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Name*
| *Description*
| *Data Type*
| *Multiplicity*

| `id`
| A unique, read-only property that serves as an identifier for the entity.
Its value is computed by the server when creating  the entity unless specified by the client.
| ANY
| 1

| `name`
| A property provides a label for Feature entity, commonly a descriptive name.
| String
| 1

| `description`
| The description about the Feature
| String
| 0..1

| `definition`
| The URI the defines this FeatureType.
Dereferencing this URI SHOULD result in a representation of the definition of the FeatureType.
| URI
| 0..1

| `properties`
| A JSON Object containing user-annotated properties as key-value pairs
| JSON Object
| 0..1
|====


[#feature-type-relations,reftext='{table-caption} {counter:table-num}']
.Direct relation between a FeatureType entity and other entity types
[width="100%",cols="3,20a,3,3",options="header"]
|====
| *Role*
| *Description*
| *Target Entity Type*
| *Multiplicity*                

| `Features`
| All Features of a FeatureType.
| `Feature`
| 0..*
|====


